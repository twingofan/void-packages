From 1b068c12b31b4a484bf49964b3057e6466b8953a Mon Sep 17 00:00:00 2001
From: "Klaus T. Aehlig" <aehlig@linta.de>
Date: Sun, 27 Aug 2023 16:35:52 +0200
Subject: [PATCH] absl: avoid off64_t

... to improve portability
---
 etc/import/absl/base/TARGETS.absl |  5 +++++
 etc/patches/direct_mmap.h.diff    | 11 +++++++++++
 2 files changed, 16 insertions(+)
 create mode 100644 etc/patches/direct_mmap.h.diff

diff --git a/etc/import/absl/base/TARGETS.absl b/etc/import/absl/base/TARGETS.absl
index 7383de5..168c1eb 100644
--- a/etc/import/absl/base/TARGETS.absl
+++ b/etc/import/absl/base/TARGETS.absl
@@ -366,6 +366,11 @@
     , "raw_logging_internal"
     ]
   }
+, "internal/direct_mmap.h":
+  { "type": ["@", "rules", "patch", "file"]
+  , "src": [["FILE", null, "internal/direct_mmap.h"]]
+  , "patch": [["@", "patches", "", "direct_mmap.h.diff"]]
+  }
 , "prefetch":
   { "type": ["@", "rules", "CC", "library"]
   , "name": ["prefetch"]
diff --git a/etc/patches/direct_mmap.h.diff b/etc/patches/direct_mmap.h.diff
new file mode 100644
index 0000000..8c400e2
--- /dev/null
+++ b/etc/patches/direct_mmap.h.diff
@@ -0,0 +1,11 @@
+--- direct_mmap.h.orig	2023-08-27 16:22:17.101255129 +0200
++++ direct_mmap.h	2023-08-27 16:23:26.048355108 +0200
+@@ -72,7 +72,7 @@
+ // Platform specific logic extracted from
+ // https://chromium.googlesource.com/linux-syscall-support/+/master/linux_syscall_support.h
+ inline void* DirectMmap(void* start, size_t length, int prot, int flags, int fd,
+-                        off64_t offset) noexcept {
++                        int64_t offset) noexcept {
+ #if defined(__i386__) || defined(__ARM_ARCH_3__) || defined(__ARM_EABI__) || \
+     defined(__m68k__) || defined(__sh__) ||                                  \
+     (defined(__hppa__) && !defined(__LP64__)) ||                             \
